{"is_source_file": true, "format": "Python", "description": "This file contains CRUD operations for a food delivery backend, including functions to create and retrieve users, restaurants, menu items, orders, payments, and deliveries, as well as updating statuses and handling related data.", "external_files": ["src/models/models"], "external_methods": ["sqlalchemy.select", "sqlalchemy.orm.Session"], "published": ["create_user", "get_user_by_email", "list_restaurants", "get_restaurant", "list_menu_items_for_restaurant", "get_menu_item", "create_order", "get_order", "set_order_status", "upsert_payment_for_order", "create_delivery", "set_delivery_status"], "classes": [{"name": "User", "description": "Represents a user in the system with email, name, role, and hashed password."}, {"name": "Restaurant", "description": "Represents a restaurant entity with relevant attributes."}, {"name": "MenuItem", "description": "Represents a menu item belonging to a restaurant, with availability status."}, {"name": "Order", "description": "Represents a customer order including total amount, status, and related info."}, {"name": "OrderItem", "description": "Represents individual items within an order, with quantity and pricing."}, {"name": "Payment", "description": "Represents payment information for an order, including provider and status."}, {"name": "Delivery", "description": "Represents a delivery record for an order, including delivery person, ETA, and status."}, {"name": "DeliveryStatusHistory", "description": "Records status changes for a delivery over time."}], "methods": [{"name": "Decimal _money_sum(values: list[Decimal])", "description": "Sums a list of Decimal monetary values.", "scope": "", "scopeKind": ""}, {"name": "User create_user(db: Session, *, email: str, name: str, role: str = \"customer\", hashed_password: Optional[str] = None)", "description": "Creates and persists a new user.", "scope": "", "scopeKind": ""}, {"name": "Optional[User] get_user_by_email(db: Session, *, email: str)", "description": "Retrieves a user record by email.", "scope": "", "scopeKind": ""}, {"name": "list[Restaurant] list_restaurants(db: Session)", "description": "Returns a list of all restaurants.", "scope": "", "scopeKind": ""}, {"name": "Optional[Restaurant] get_restaurant(db: Session, *, restaurant_id: int)", "description": "Fetches a restaurant by its ID.", "scope": "", "scopeKind": ""}, {"name": "list[MenuItem] list_menu_items_for_restaurant(db: Session, *, restaurant_id: int, only_available: bool = True)", "description": "Lists menu items for a given restaurant, optionally filtered by availability.", "scope": "", "scopeKind": ""}, {"name": "Optional[MenuItem] get_menu_item(db: Session, *, menu_item_id: int)", "description": "Fetches a menu item by its ID.", "scope": "", "scopeKind": ""}, {"name": "Order create_order( db: Session, *, user_id: int, restaurant_id: int, delivery_address: Optional[str], items: list[dict], )", "description": "Creates an order with associated order items and total amount calculation.", "scope": "", "scopeKind": ""}, {"name": "Optional[Order] get_order(db: Session, *, order_id: int)", "description": "Retrieves an order by ID.", "scope": "", "scopeKind": ""}, {"name": "Order set_order_status(db: Session, *, order_id: int, status: str)", "description": "Updates the status of an existing order.", "scope": "", "scopeKind": ""}, {"name": "Payment upsert_payment_for_order( db: Session, *, order_id: int, provider: str, amount: Decimal, status: str = \"pending\", provider_payment_id: Optional[str] = None, raw_payload: Optional[str] = None, )", "description": "Creates or updates a payment record for an order.", "scope": "", "scopeKind": ""}, {"name": "Delivery create_delivery(db: Session, *, order_id: int, delivery_person_id: Optional[int] = None, eta_minutes: Optional[int] = None)", "description": "Creates a delivery entry and initial status history for an order.", "scope": "", "scopeKind": ""}, {"name": "Delivery set_delivery_status(db: Session, *, delivery_id: int, status: str, note: Optional[str] = None)", "description": "Updates the status of a delivery and appends to its history.", "scope": "", "scopeKind": ""}], "calls": ["select", "db.scalar", "db.get", "db.scalars", "db.add", "db.add_all", "db.commit", "db.refresh", "select", "db.scalar", "db.get", "db.add", "db.add_all", "db.commit", "db.refresh"], "search-terms": ["CRUD", "food delivery", "orders", "payments", "deliveries", "restaurant menu"], "state": 2, "file_id": 14, "knowledge_revision": 31, "git_revision": "522fd31268126df6cf88d0e597b3b54223ad0948", "ctags": [{"_type": "tag", "name": "_money_sum", "path": "/home/kavia/workspace/code-generation/gourmet-express-216707-216717/food_delivery_backend/src/crud/crud.py", "pattern": "/^def _money_sum(values: list[Decimal]) -> Decimal:$/", "language": "Python", "typeref": "typename:Decimal", "kind": "function", "signature": "(values: list[Decimal])"}, {"_type": "tag", "name": "create_delivery", "path": "/home/kavia/workspace/code-generation/gourmet-express-216707-216717/food_delivery_backend/src/crud/crud.py", "pattern": "/^def create_delivery(db: Session, *, order_id: int, delivery_person_id: Optional[int] = None, eta/", "language": "Python", "typeref": "typename:Delivery", "kind": "function", "signature": "(db: Session, *, order_id: int, delivery_person_id: Optional[int] = None, eta_minutes: Optional[int] = None)"}, {"_type": "tag", "name": "create_order", "path": "/home/kavia/workspace/code-generation/gourmet-express-216707-216717/food_delivery_backend/src/crud/crud.py", "pattern": "/^def create_order($/", "language": "Python", "typeref": "typename:Order", "kind": "function", "signature": "( db: Session, *, user_id: int, restaurant_id: int, delivery_address: Optional[str], items: list[dict], )"}, {"_type": "tag", "name": "create_user", "path": "/home/kavia/workspace/code-generation/gourmet-express-216707-216717/food_delivery_backend/src/crud/crud.py", "pattern": "/^def create_user(db: Session, *, email: str, name: str, role: str = \"customer\", hashed_password: /", "language": "Python", "typeref": "typename:User", "kind": "function", "signature": "(db: Session, *, email: str, name: str, role: str = \"customer\", hashed_password: Optional[str] = None)"}, {"_type": "tag", "name": "get_menu_item", "path": "/home/kavia/workspace/code-generation/gourmet-express-216707-216717/food_delivery_backend/src/crud/crud.py", "pattern": "/^def get_menu_item(db: Session, *, menu_item_id: int) -> Optional[MenuItem]:$/", "language": "Python", "typeref": "typename:Optional[MenuItem]", "kind": "function", "signature": "(db: Session, *, menu_item_id: int)"}, {"_type": "tag", "name": "get_order", "path": "/home/kavia/workspace/code-generation/gourmet-express-216707-216717/food_delivery_backend/src/crud/crud.py", "pattern": "/^def get_order(db: Session, *, order_id: int) -> Optional[Order]:$/", "language": "Python", "typeref": "typename:Optional[Order]", "kind": "function", "signature": "(db: Session, *, order_id: int)"}, {"_type": "tag", "name": "get_restaurant", "path": "/home/kavia/workspace/code-generation/gourmet-express-216707-216717/food_delivery_backend/src/crud/crud.py", "pattern": "/^def get_restaurant(db: Session, *, restaurant_id: int) -> Optional[Restaurant]:$/", "language": "Python", "typeref": "typename:Optional[Restaurant]", "kind": "function", "signature": "(db: Session, *, restaurant_id: int)"}, {"_type": "tag", "name": "get_user_by_email", "path": "/home/kavia/workspace/code-generation/gourmet-express-216707-216717/food_delivery_backend/src/crud/crud.py", "pattern": "/^def get_user_by_email(db: Session, *, email: str) -> Optional[User]:$/", "language": "Python", "typeref": "typename:Optional[User]", "kind": "function", "signature": "(db: Session, *, email: str)"}, {"_type": "tag", "name": "list_menu_items_for_restaurant", "path": "/home/kavia/workspace/code-generation/gourmet-express-216707-216717/food_delivery_backend/src/crud/crud.py", "pattern": "/^def list_menu_items_for_restaurant(db: Session, *, restaurant_id: int, only_available: bool = Tr/", "language": "Python", "typeref": "typename:list[MenuItem]", "kind": "function", "signature": "(db: Session, *, restaurant_id: int, only_available: bool = True)"}, {"_type": "tag", "name": "list_restaurants", "path": "/home/kavia/workspace/code-generation/gourmet-express-216707-216717/food_delivery_backend/src/crud/crud.py", "pattern": "/^def list_restaurants(db: Session) -> list[Restaurant]:$/", "language": "Python", "typeref": "typename:list[Restaurant]", "kind": "function", "signature": "(db: Session)"}, {"_type": "tag", "name": "set_delivery_status", "path": "/home/kavia/workspace/code-generation/gourmet-express-216707-216717/food_delivery_backend/src/crud/crud.py", "pattern": "/^def set_delivery_status(db: Session, *, delivery_id: int, status: str, note: Optional[str] = Non/", "language": "Python", "typeref": "typename:Delivery", "kind": "function", "signature": "(db: Session, *, delivery_id: int, status: str, note: Optional[str] = None)"}, {"_type": "tag", "name": "set_order_status", "path": "/home/kavia/workspace/code-generation/gourmet-express-216707-216717/food_delivery_backend/src/crud/crud.py", "pattern": "/^def set_order_status(db: Session, *, order_id: int, status: str) -> Order:$/", "language": "Python", "typeref": "typename:Order", "kind": "function", "signature": "(db: Session, *, order_id: int, status: str)"}, {"_type": "tag", "name": "upsert_payment_for_order", "path": "/home/kavia/workspace/code-generation/gourmet-express-216707-216717/food_delivery_backend/src/crud/crud.py", "pattern": "/^def upsert_payment_for_order($/", "language": "Python", "typeref": "typename:Payment", "kind": "function", "signature": "( db: Session, *, order_id: int, provider: str, amount: Decimal, status: str = \"pending\", provider_payment_id: Optional[str] = None, raw_payload: Optional[str] = None, )"}], "hash": "94c680254c8be3bb3547d864385fb6db", "format-version": 4, "code-base-name": "food_delivery_backend", "filename": "food_delivery_backend/src/crud/crud.py", "revision_history": [{"31": "522fd31268126df6cf88d0e597b3b54223ad0948"}]}